<% provide(:title, t(".title", portfolio_title: @portfolio.title)) %>
<% provide(:submit_text, t("btn.create")) %>
<h1>Portfolios#show</h1>
<div id="portfolio-<%= @portfolio.id %>">
  <%= link_to @portfolio.user.username, @portfolio.user %>
  <span class="timestamp">
    <%= t("common.time_ago", time: time_ago_in_words(@portfolio.created_at)) %>
  </span>
  <% if @portfolio.user == current_user %>
    <span class="pageview">
      <%= t("common.pageview", score: score(@portfolio)) %>
    </span>
  <% end %>
  <% if user_signed_in? %>
    <%= render 'favorites/favorite_form', { portfolio: @portfolio, user: @portfolio.user } %>
    <%= link_to t(".progress_index"), portfolio_progresses_path(@portfolio), class: "progress_index" %>
    <%= link_to t(".progress_edit"), new_portfolio_progress_path(@portfolio), class: "progress_new" %>
  <% end %>
  <%= link_to @portfolio.title, @portfolio, class: "title" %> <span class="favorite_count">(<%= @portfolio.favorite_users.count %>)</span>
  <span class="content"><%= @portfolio.content %></span>
  <% if @portfolio.image? %>
    <%= image_tag @portfolio.image.url, class: "image" %>
  <% end %>
  <%= link_to t(".web_url"), @portfolio.web_url, class: "web_url" %>
  <%= link_to t(".git_url"), @portfolio.git_url, class: "git_url" %>
  <% if current_user?(@portfolio.user) %>
    <%= link_to t("btn.edit"), edit_portfolio_path(@portfolio) %>
    <%= link_to t("btn.delete"), @portfolio, method: :delete,
                data: { confirm: t("common.delete_confirmation") } %>
  <% end %>
  <h2>プログレス</h2>
  <div id="progress">
    <%= link_to "##{get_number(@portfolio, @progress)}", portfolio_progress_path(@portfolio, @progress), class: "id" %>
    <% unless @progress.comments.count == 0 %>
      <span class="evaluation">評価：<%= average_evaluation(@progress) %>（<%= @progress.comments.count %> 件）</span>
    <% end %>
    <span class="content"><%= @progress.content %></span>
    <% if @portfolio.user == current_user %>
      <%= link_to t("btn.edit"), edit_portfolio_progress_path(@portfolio, @progress) %>
    <% end %>
    <% unless @comments == nil %>
    <div id="comments">
      <ol>
        <%= render @comments, portfolio: @portfolio, progress: @progress %>
      </ol>
    </div>
    <% end %>
    <%= render "comments/comment_form" %>
  </div>
</div>
